-- LocalScript –≤ StarterPlayerScripts
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")

-- –ñ–¥–µ–º –∏–≥—Ä–æ–∫–∞
local player = Players.LocalPlayer
if not player then
    player = Players.PlayerAdded:Wait()
end

-- –§–∏–æ–ª–µ—Ç–æ–≤—ã–µ —Ü–≤–µ—Ç–∞ –¥–ª—è Soj-Mod
local SOJ_PURPLE = Color3.fromRGB(138, 43, 226)
local SOJ_DARK_PURPLE = Color3.fromRGB(75, 0, 130)
local SOJ_LIGHT_PURPLE = Color3.fromRGB(147, 112, 219)

-- –°–æ–∑–¥–∞–µ–º —ç–∫—Ä–∞–Ω–Ω—ã–π GUI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "SojModGUI"
screenGui.ResetOnSpawn = false
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
screenGui.Parent = player:WaitForChild("PlayerGui")

-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è GUI
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 300, 0, 180)
mainFrame.Position = UDim2.new(0.5, -150, 0.1, 0)
mainFrame.AnchorPoint = Vector2.new(0.5, 0)
mainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
mainFrame.BackgroundTransparency = 0.1
mainFrame.BorderSizePixel = 0
mainFrame.Visible = false
mainFrame.Parent = screenGui

-- –°–∫—Ä—É–≥–ª–µ–Ω–∏–µ —É–≥–ª–æ–≤
local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 8)
corner.Parent = mainFrame

-- –û–±–≤–æ–¥–∫–∞
local stroke = Instance.new("UIStroke")
stroke.Color = SOJ_PURPLE
stroke.Thickness = 2
stroke.Transparency = 0.3
stroke.Parent = mainFrame

-- –ó–∞–≥–æ–ª–æ–≤–æ–∫
local title = Instance.new("TextLabel")
title.Name = "Title"
title.Size = UDim2.new(1, 0, 0, 30)
title.Position = UDim2.new(0, 0, 0, 0)
title.BackgroundColor3 = SOJ_DARK_PURPLE
title.BackgroundTransparency = 0.1
title.Text = "üõ†Ô∏è SOJ-MOD"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.TextSize = 16
title.Font = Enum.Font.SourceSansBold
title.BorderSizePixel = 0
title.Parent = mainFrame

-- –¢–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º
local modeLabel = Instance.new("TextLabel")
modeLabel.Name = "ModeLabel"
modeLabel.Size = UDim2.new(1, -20, 0, 35)
modeLabel.Position = UDim2.new(0, 10, 0, 35)
modeLabel.BackgroundTransparency = 1
modeLabel.Text = "SELECT"
modeLabel.TextColor3 = SOJ_PURPLE
modeLabel.TextSize = 18
modeLabel.Font = Enum.Font.SourceSansBold
modeLabel.Parent = mainFrame

-- –û–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∂–∏–º–∞
local descLabel = Instance.new("TextLabel")
descLabel.Name = "DescLabel"
descLabel.Size = UDim2.new(1, -20, 0, 50)
descLabel.Position = UDim2.new(0, 10, 0, 75)
descLabel.BackgroundTransparency = 1
descLabel.Text = "Select objects to build"
descLabel.TextColor3 = SOJ_LIGHT_PURPLE
descLabel.TextSize = 12
descLabel.Font = Enum.Font.SourceSans
descLabel.TextWrapped = true
descLabel.Parent = mainFrame

-- –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è
local closeButton = Instance.new("TextButton")
closeButton.Name = "CloseButton"
closeButton.Size = UDim2.new(0, 80, 0, 25)
closeButton.Position = UDim2.new(0.5, -40, 1, -30)
closeButton.BackgroundColor3 = SOJ_DARK_PURPLE
closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
closeButton.Text = "CLOSE"
closeButton.TextSize = 12
closeButton.Font = Enum.Font.SourceSansBold
closeButton.Parent = mainFrame

closeButton.MouseButton1Click:Connect(function()
    mainFrame.Visible = false
end)

-- –°–ø–∏—Å–æ–∫ —Ä–µ–∂–∏–º–æ–≤
local modes = {
    {Name = "SELECT", Desc = "Select objects to build", Color = SOJ_PURPLE},
    {Name = "MOVE", Desc = "Move selected objects", Color = SOJ_LIGHT_PURPLE},
    {Name = "ROTATE", Desc = "Rotate selected objects", Color = Color3.fromRGB(200, 100, 255)},
    {Name = "SCALE", Desc = "Scale selected objects", Color = Color3.fromRGB(170, 60, 240)},
    {Name = "MATERIAL", Desc = "Change material", Color = Color3.fromRGB(130, 40, 200)},
    {Name = "COLOR", Desc = "Change color", Color = Color3.fromRGB(180, 80, 250)},
    {Name = "COLLISION", Desc = "Toggle collision", Color = Color3.fromRGB(100, 30, 160)},
    {Name = "ANCHOR", Desc = "Anchor objects", Color = Color3.fromRGB(60, 10, 100)},
    {Name = "DUPLICATE", Desc = "Duplicate objects", Color = Color3.fromRGB(120, 50, 180)},
    {Name = "WELD", Desc = "Weld objects", Color = Color3.fromRGB(90, 40, 150)},
    {Name = "NEGATIVE", Desc = "Remove parts", Color = Color3.fromRGB(220, 80, 80)},
    {Name = "POSITIVE", Desc = "Add parts", Color = Color3.fromRGB(80, 220, 80)},
    {Name = "CLONE", Desc = "Clone parts", Color = Color3.fromRGB(80, 80, 220)}
}

local currentMode = 1
local isToolEquipped = false

-- –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è GUI
local function updateGUI()
    local mode = modes[currentMode]
    modeLabel.Text = mode.Name
    modeLabel.TextColor3 = mode.Color
    descLabel.Text = mode.Desc .. "\nRightClick: Next Mode"
end

-- –°–æ–∑–¥–∞–µ–º –ø—Ä–æ—Å—Ç–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç
local function createSojModTool()
    local tool = Instance.new("Tool")
    tool.Name = "SOJ-MOD"
    tool.RequiresHandle = true
    tool.ToolTip = "Soj-Mod Building Tool - RightClick to change mode"
    
    -- –ü—Ä–æ—Å—Ç–∞—è —Ä—É—á–∫–∞
    local handle = Instance.new("Part")
    handle.Name = "Handle"
    handle.Size = Vector3.new(0.5, 0.5, 2)
    handle.BrickColor = BrickColor.fromColor3(SOJ_PURPLE)
    handle.Material = Enum.Material.Neon
    handle.Transparency = 0.1
    handle.CanCollide = false
    handle.Parent = tool
    
    -- –ü–æ–¥—Å–≤–µ—Ç–∫–∞
    local light = Instance.new("PointLight")
    light.Brightness = 3
    light.Range = 5
    light.Color = SOJ_PURPLE
    light.Parent = handle
    
    -- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
    tool.Equipped:Connect(function()
        isToolEquipped = true
        mainFrame.Visible = true
        updateGUI()
    end)
    
    tool.Unequipped:Connect(function()
        isToolEquipped = false
        mainFrame.Visible = false
    end)
    
    tool.Activated:Connect(function()
        currentMode = (currentMode % #modes) + 1
        updateGUI()
        handle.BrickColor = BrickColor.fromColor3(modes[currentMode].Color)
    end)
    
    return tool
end

-- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–∏ –º—ã—à–∏
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed or not isToolEquipped then return end
    
    if input.UserInputType == Enum.UserInputType.MouseButton2 then
        currentMode = (currentMode % #modes) + 1
        updateGUI()
        
        -- –ú–µ–Ω—è–µ–º —Ü–≤–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
        local character = player.Character
        if character then
            local tool = character:FindFirstChildWhichIsA("Tool")
            if tool and tool:FindFirstChild("Handle") then
                tool.Handle.BrickColor = BrickColor.fromColor3(modes[currentMode].Color)
            end
        end
    end
end)

-- –§—É–Ω–∫—Ü–∏—è –≤—ã–¥–∞—á–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
local function giveSojModTool()
    local success, err = pcall(function()
        local backpack = player:WaitForChild("Backpack")
        
        -- –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç
        local oldTool = backpack:FindFirstChild("SOJ-MOD")
        if oldTool then
            oldTool:Destroy()
        end
        
        wait(0.1)
        
        -- –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç
        local tool = createSojModTool()
        tool.Parent = backpack
        
        return true
    end)
    
    if not success then
        warn("Error giving tool: " .. tostring(err))
        return false
    end
    return true
end

-- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤—ã–¥–∞—á–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
local function initialize()
    wait(2) -- –ñ–¥–µ–º –∑–∞–≥—Ä—É–∑–∫–∏
    
    local success = giveSojModTool()
    if success then
        print("‚úÖ SOJ-MOD tool created successfully!")
        print("üéÆ Equip the tool to see GUI")
    else
        print("‚ùå Failed to create tool, retrying...")
        wait(2)
        giveSojModTool()
    end
end

-- –ó–∞–ø—É—Å–∫–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é
spawn(initialize)

-- –í—ã–¥–∞—á–∞ –ø—Ä–∏ —Ä–µ—Å–ø–∞–≤–Ω–µ
player.CharacterAdded:Connect(function(character)
    wait(3) -- –ñ–¥–µ–º –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
    giveSojModTool()
end)

-- –ö–æ–º–∞–Ω–¥—ã —á–∞—Ç–∞
player.Chatted:Connect(function(message)
    message = string.lower(message)
    if message == "/soj" or message == "!soj" then
        giveSojModTool()
    elseif message == "/gui" then
        mainFrame.Visible = not mainFrame.Visible
    end
end)

-- –ì–æ—Ä—è—á–∞—è –∫–ª–∞–≤–∏—à–∞ F3
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    if input.KeyCode == Enum.KeyCode.F3 then
        giveSojModTool()
    end
end)

-- –î—Ä–∞–≥–≥–∏–Ω–≥ GUI
local dragging = false
local dragStart = nil
local startPos = nil

title.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = mainFrame.Position
    end
end)

UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = false
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Position - dragStart
        mainFrame.Position = UDim2.new(
            startPos.X.Scale, startPos.X.Offset + delta.X,
            startPos.Y.Scale, startPos.Y.Offset + delta.Y
        )
    end
end)

-- –§–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
print("====================================")
print("üéÆ SOJ-MOD BUILDER LOADED!")
print("üõ†Ô∏è Tool: SOJ-MOD (check your backpack)")
print("üé® Purple theme activated")
print("üñ±Ô∏è RightClick to change modes")
print("‚å®Ô∏è F3 - Get tool again")
print("üí¨ /soj - Get tool, /gui - Toggle GUI")
print("====================================")
